<!DOCTYPE html>
	<head>
		<title>IBV - Kontostreng lookup</title>

	  	<!-- Content type & charset -->
	    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

	    <!-- Viewport scaling -->
	    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=yes">

	    <!-- Search engine results -->
	    <meta name="description" content="A site made for UiO IBV to allow employees to lookup 'konstostrenger'">
	    <meta name="author" content="Sanguinary">
	    <meta name="keywords" content="kontostrenger, UiO, finn, kontostreng">

		<!-- CSS -->
		<link href="assets/css/style.css" rel="stylesheet">
	    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	    <link href="https://fonts.googleapis.com/css?family=Open+Sans|Quicksand" rel="stylesheet">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />

		<!-- Scripts -->
	    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha256-3edrmyuQ0w65f8gfBsqowzjJe2iM6n0nKciPUp8y+7E=" crossorigin="anonymous"></script>
	    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="unknown"></script>
	    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	  	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	</head>
	<body>
		<div class="head-wrapper">
			<div class="uio-app-line-top">
      			<div class="uio-logo norwegian">
        			<a href="http://www.uio.no">Universitetet i Oslo</a>
      			</div>
    		</div>
		</div>
	  	<div class="container">
    		<h1 id="overskrift" align="center">Finn konto/kontostreng på IBV</h1>
    		<!-- antall oppføringer -->
    		<div id="oppforinger_totalt">Totalt antall oppføringer: </div>
    		<!--<div id="oppforinger_dynamisk">Antall oppføringer som vises etter søk: </div>-->

    		<!-- kontostreng søk -->
    		<div id="kontostreng_sok"><input type="input" name="kontostreng_input" id="kontostreng_input" class="form-control" placeholder="Skriv inn relevant informasjon..."></div>    			
    		<table class="table table-bordered table-striped" style="margin-top:20px; margin-bottom:0px !important;">
				<tr>
					<th>Etternavn</th>
					<th>Fornavn</th>
					<th>Sted</th>
					<th>Prosjekt</th>
					<th>Tiltak</th>
					<th>Prosjektnavn</th>
					<th>Kode</th>
					<th>Finansieringskode</th>
				</tr>
    		</table>
    		<div class="table-responsive">
    			<!-- kontostreng tabell m/ relevant info-->

    			<div id="kontostreng_table">
    				<!-- table contents generated by AJAX here -->
    			</div>
   			</div>
	  	</div>
	</body>
	<script>
	//loader all content og intialiserer jquery
	$(document).ready(function(){
		//starter AJAX
		$.ajax({
			//definerer hvilken data og hva den inneholder
			url:"assets/txt/kontostrenger_bio.csv",
			dataType:"text",
			success: function (data) {

			//definerer variabler som parser inneholdet i filen
	    	var kontostreng_data = data.split(/\r?\n|\r/);
	    	var table_data = '<table class="table table-bordered table-striped">';

	    		//looper gjennom alle linjene i filen og splitter på hver semikolon // starter å telle fra rad 1 her.
		    	for(var count = 2; count<kontostreng_data.length; count++) {
		     		var cell_data = kontostreng_data[count].split(";");
		     		
		     		table_data += '<tr>';

		     		//generer en tabell for hver linje
		     		for(var cell_count=0; cell_count<8; cell_count++) {
		       			table_data += '<td>'+cell_data[cell_count]+'</td>';
		     		}

		     		//generer tabell med table header
		     		//for(var cell_count=0; cell_count<8; cell_count++) {
		     		//	//på rad 1, lag thead
		      		//	if(count === 1) {
		       		//		table_data += '<th>'+cell_data[cell_count]+'</th>';
		      		//	}
		      		//	//alt annet som ikke er 1 (og ikke 0, fordi vi startet på 1) lag en table default
		      		//	else {
		       		//		table_data += '<td>'+cell_data[cell_count]+'</td>';
		      		//	}
		     		//}

		     		table_data += '</tr>';
		    	}
	    		table_data += '</table>';
	    		//definerer hva som skal hvor i HTML siden
	    		$('#kontostreng_table').html(table_data);
	    		$('#oppforinger_totalt').append("<b>" + count + "</b>");

	   		}	
	  	});

		//automatisk søkefiltrering for hvert tastetrykk
	  	$("#kontostreng_input").on("keyup", function() {
    		var value = $(this).val().toLowerCase();
    		$("#kontostreng_table tr:not(:has(th))").filter(function() {
      			$(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)

    		});
  		});
	});

	</script>
</html>


